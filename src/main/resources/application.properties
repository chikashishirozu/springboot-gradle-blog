# Spring Boot Blog - 共通設定
spring.application.name=blog

# デフォルトプロファイルを開発用に変更（または指定しない）
# spring.profiles.active=  # コメントアウトまたは削除

# サーバーポート
server.port=8080

# Hibernateの自動DDLを無効化
spring:
  jpa:
    hibernate:
      ddl-auto: validate  # または none
    properties:
      hibernate:
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
  
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

# DevToolsのライブリロードを有効化
spring.devtools.livereload.enabled=true
spring.devtools.restart.enabled=true

# 静的リソースの監視パス
spring.devtools.restart.additional-paths=src/main/resources/static,src/main/resources/templates
spring.devtools.restart.exclude=static/**,templates/**

# キャッシュ無効化
spring.thymeleaf.cache=false
spring.resources.cache.period=0
spring.web.resources.cache.period=0

# Actuatorエンドポイント有効化
management.endpoints.web.exposure.include=mappings,health,info
management.endpoint.mappings.enabled=true

# Docker composeのPostgreSQL開発用（必要に応じて）
spring.datasource.url=jdbc:postgresql://localhost:5432/blog_dev
spring.datasource.username=blog_dev_user
spring.datasource.password=dev_password_123

# または環境変数を使用
# spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/blog_dev}
# spring.datasource.username=${DATABASE_USER:blog_dev_user}
# spring.datasource.password=${DATABASE_PASSWORD:dev_password_123}

# JPA開発設定
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Flyway設定
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

# H2 Console（開発用）
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# ログ設定
logging.level.root=INFO
# 詳細なログを有効化
logging.level.com.example.blog=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Flywayの詳細ログ
logging.level.org.flywaydb=DEBUG

# セッション設定
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true

# ファイルアップロード設定
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# CSRFデバッグ
logging.level.org.springframework.security.web.csrf=DEBUG

# 詳細なログインフォーム処理
logging.level.org.springframework.security.web.authentication=TRACE
